<?php\n\nrequire_once __DIR__ . \'/vendor/autoload.php\';\n\nuse Monolog\\Logger;\nuse Monolog\\Handler\\StreamHandler;\nuse Dotenv\\Dotenv;\n\n// Load .env variables\n$dotenv = Dotenv::createImmutable(__DIR__);\n$dotenv->load();\n\n// Logger Setup\n$logLevel = Logger::toMonologLevel($_ENV[\'LOG_LEVEL\'] ?? \'INFO\');\n$log = new Logger(\'setup_db\');\n$log->pushHandler(new StreamHandler(__DIR__ . \'/app.log\', $logLevel));\n\n// Database credentials from environment variables\n$db_host = $_ENV[\'DB_HOST\'] ?? \'localhost\';\n$db_name = $_ENV[\'DB_NAME\'] ?? \'lottery_app\';\n$db_user = $_ENV[\'DB_USER\'] ?? \'root\';\n$db_pass = $_ENV[\'DB_PASS\'] ?? \'\';\n\ntry {\n    // 1. Connect to MySQL without specifying a database\n    $pdoc = new PDO(\"mysql:host=$db_host\", $db_user, $db_pass);\n    $pdoc->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n\n    // 2. Create the database if it doesn\'t exist\n    $pdoc->exec(\"CREATE DATABASE IF NOT EXISTS `$db_name` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci\");\n    echo \"Database \'$db_name\' created or already exists.\\\n\";\n    $log->info(\"Database \'$db_name\' created or already exists.\");\n\n    // 3. Connect to the newly created database\n    $pdo = new PDO(\"mysql:host=$db_host;dbname=$db_name\", $db_user, $db_pass);\n    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n\n    // 4. Read the SQL schema from the .sql file\n    $sql = file_get_contents(__DIR__ . \'/data_table_schema.sql\');\n    if ($sql === false) {\n        throw new Exception(\"Could not read the data_table_schema.sql file.\");\n    }\n\n    // 5. Execute the SQL to create the tables\n    $pdo->exec($sql);\n    echo \"Tables created successfully.\\\n\";\n    $log->info(\"Tables created successfully.\");\n\n} catch (PDOException $e) {\n    $log->error(\"Database error during setup: \" . $e->getMessage());\n    echo \"Error setting up database. Check logs for details.\\\n\";\n    exit(1); // Exit with an error code\n} catch (Exception $e) {\n    $log->error(\"General error during setup: \" . $e->getMessage());\n    echo \"Error setting up database. Check logs for details.\\\n\";\n    exit(1); // Exit with an error code\n}\n\n?>