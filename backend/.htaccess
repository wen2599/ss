# Block access to sensitive files
<FilesMatch "(\.env|\.log|config\.php|database_schema\.sql|initialize_database\.php)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Enable rewriting
RewriteEngine On

# Redirect all requests to /api/ to the main router
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^api/(.*)$ index.php [L]

# Redirect requests with ?endpoint= to the main router
RewriteCond %{REQUEST_URI} !^/index\.php$
RewriteCond %{QUERY_STRING} ^endpoint=
RewriteRule ^(.*)$ index.php [L]