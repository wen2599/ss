<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /

  # Rule 1: Route all API calls to the backend
  # If the query string contains 'action=', rewrite to the backend entry point.
  RewriteCond %{QUERY_STRING} action= [NC]
  RewriteRule ^/?$ backend/index.php [L,QSA]

  # Rule 2: Serve existing files and directories directly
  # This prevents the client-side routing rule from breaking links to images, css, etc.
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d

  # Rule 3: Handle client-side routing for the React application
  # For any other request, serve the main index.html file and let React Router take over.
  RewriteRule . /frontend/index.html [L]
</IfModule>