<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>实时开奖结果</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: #f0f2f5; margin: 0; padding: 20px; color: #333; }
        h1 { text-align: center; color: #1a237e; margin-bottom: 30px; }
        #lottery-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; max-width: 1200px; margin: 0 auto; }
        .lottery-card { background-color: #ffffff; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); padding: 20px; transition: transform 0.2s; }
        .lottery-card:hover { transform: translateY(-5px); }
        .card-header { border-bottom: 1px solid #e8eaf6; padding-bottom: 15px; margin-bottom: 15px; }
        .lottery-title { font-size: 1.5em; font-weight: bold; color: #303f9f; margin: 0; }
        .lottery-issue { font-size: 0.9em; color: #757575; }
        .results-grid { display: grid; grid-template-rows: repeat(3, auto); gap: 15px; }
        .result-row { display: flex; align-items: center; justify-content: space-around; background-color: #f8f9fa; border-radius: 8px; padding: 10px; }
        .number-ball { width: 40px; height: 40px; display: flex; justify-content: center; align-items: center; border-radius: 50%; color: #fff; font-weight: bold; font-size: 1.1em; }
        .zodiac, .color-emoji { font-size: 1.2em; text-align: center; width: 40px; }
        /* Color mapping */
        .color-red { background: linear-gradient(145deg, #f44336, #d32f2f); }
        .color-green { background: linear-gradient(145deg, #4CAF50, #388E3C); }
        .color-blue { background: linear-gradient(145deg, #2196F3, #1976D2); }
        .placeholder { text-align: center; padding: 40px; color: #9e9e9e; }
        #error-message { text-align: center; color: #d32f2f; background-color: #ffebee; padding: 15px; border-radius: 8px; display: none; max-width: 600px; margin: 20px auto; }
    </style>
</head>
<body>
    <h1>多彩实时开奖</h1>
    <div id="error-message"></div>
    <div id="lottery-container"></div>

    <script>
        // Map color names from data to CSS classes
        const colorClassMap = {
            '🔴': 'color-red',
            '🟢': 'color-green',
            '🔵': 'color-blue',
        };

        function createLotteryCard(title, data) {
            if (!data) {
                return `
                    <div class="lottery-card">
                        <div class="card-header">
                            <h2 class="lottery-title">${title}</h2>
                        </div>
                        <div class="placeholder">
                            <p>暂无最新开奖数据</p>
                        </div>
                    </div>
                `;
            }

            const numbersHtml = data.numbers.map((num, i) => 
                `<div class="number-ball ${colorClassMap[data.colors[i]] || ''}">${num}</div>`).join('');
            const zodiacsHtml = data.zodiacs.map(z => `<div class="zodiac">${z}</div>`).join('');
            const colorsHtml = data.colors.map(c => `<div class="color-emoji">${c}</div>`).join('');

            return `
                <div class="lottery-card">
                    <div class="card-header">
                        <h2 class="lottery-title">${title}</h2>
                        <p class="lottery-issue">第 ${data.issue} 期</p>
                    </div>
                    <div class="results-grid">
                        <div class="result-row">${numbersHtml}</div>
                        <div class="result-row">${zodiacsHtml}</div>
                        <div class="result-row">${colorsHtml}</div>
                    </div>
                </div>
            `;
        }

        async function fetchLotteryData() {
            const container = document.getElementById('lottery-container');
            const errorEl = document.getElementById('error-message');

            try {
                // The backend endpoint now returns an object with keys for each lottery type
                const response = await fetch('backend/endpoints/get_numbers.php');
                if (!response.ok) {
                    throw new Error(`网络错误: ${response.statusText}`);
                }
                const data = await response.json();

                // Clear previous content
                container.innerHTML = '';

                // Define the order and titles for display
                const displayOrder = ['新澳门六合彩', '香港六合彩', '老澳21.30'];

                for (const title of displayOrder) {
                    container.innerHTML += createLotteryCard(title, data[title]);
                }

            } catch (error) {
                console.error('获取开奖数据失败:', error);
                errorEl.textContent = '无法加载开奖数据，请稍后重试。';
                errorEl.style.display = 'block';
                container.innerHTML = '<div class="placeholder"><p>数据加载失败</p></div>';
            }
        }

        // Fetch data on page load
        document.addEventListener('DOMContentLoaded', fetchLotteryData);
    </script>
</body>
</html>
