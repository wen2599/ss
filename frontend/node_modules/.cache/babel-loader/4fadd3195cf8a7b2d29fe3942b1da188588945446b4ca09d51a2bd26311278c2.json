{"ast":null,"code":"import React,{useState}from'react';import'./PointsManager.css';import{findUser,transferPoints}from'../api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function PointsManager(_ref){let{currentUser,onClose,onTransferSuccess}=_ref;const[searchPhone,setSearchPhone]=useState('');const[searchResult,setSearchResult]=useState(null);const[message,setMessage]=useState('');const[recipientId,setRecipientId]=useState('');const[amount,setAmount]=useState('');const handleSearch=async e=>{e.preventDefault();setMessage('');setSearchResult(null);if(!searchPhone){setMessage('请输入要查询的手机号');return;}const response=await findUser(searchPhone);if(response.success){setSearchResult(`查询结果: 手机号 ${searchPhone} 对应的ID是 ${response.user.displayId}`);}else{setMessage(response.message||'查询失败');}};const handleTransfer=async e=>{e.preventDefault();setMessage('');const transferAmount=parseInt(amount,10);if(!recipientId||!transferAmount||transferAmount<=0){setMessage('请输入有效的接收人ID和大于0的积分数量');return;}const response=await transferPoints(recipientId,transferAmount);if(response.success){setMessage(response.message);setRecipientId('');setAmount('');// Notify App.js to refresh the user's points\nonTransferSuccess();}else{setMessage(response.message||'赠送失败');}};return/*#__PURE__*/_jsx(\"div\",{className:\"points-modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"points-modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"button\",{className:\"close-button\",onClick:onClose,children:\"X\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"\\u79EF\\u5206\\u7BA1\\u7406\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"points-balance\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u6211\\u7684\\u79EF\\u5206\"}),/*#__PURE__*/_jsx(\"p\",{children:currentUser===null||currentUser===void 0?void 0:currentUser.points})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-search\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u67E5\\u8BE2\\u73A9\\u5BB6ID\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSearch,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u8F93\\u5165\\u5BF9\\u65B9\\u624B\\u673A\\u53F7\",value:searchPhone,onChange:e=>setSearchPhone(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"\\u67E5\\u8BE2\"})]}),searchResult&&/*#__PURE__*/_jsx(\"p\",{className:\"search-result\",children:searchResult})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"points-transfer\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u8D60\\u9001\\u79EF\\u5206\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleTransfer,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u5BF9\\u65B9ID\",value:recipientId,onChange:e=>setRecipientId(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"\\u8D60\\u9001\\u6570\\u91CF\",value:amount,onChange:e=>setAmount(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"\\u786E\\u8BA4\\u8D60\\u9001\"})]})]}),message&&/*#__PURE__*/_jsx(\"p\",{className:\"message\",children:message})]})});}export default PointsManager;","map":{"version":3,"names":["React","useState","findUser","transferPoints","jsx","_jsx","jsxs","_jsxs","PointsManager","_ref","currentUser","onClose","onTransferSuccess","searchPhone","setSearchPhone","searchResult","setSearchResult","message","setMessage","recipientId","setRecipientId","amount","setAmount","handleSearch","e","preventDefault","response","success","user","displayId","handleTransfer","transferAmount","parseInt","className","onClick","children","stopPropagation","points","onSubmit","type","placeholder","value","onChange","target"],"sources":["/app/frontend/src/components/PointsManager.js"],"sourcesContent":["import React, { useState } from 'react';\nimport './PointsManager.css';\nimport { findUser, transferPoints } from '../api';\n\nfunction PointsManager({ currentUser, onClose, onTransferSuccess }) {\n  const [searchPhone, setSearchPhone] = useState('');\n  const [searchResult, setSearchResult] = useState(null);\n  const [message, setMessage] = useState('');\n\n  const [recipientId, setRecipientId] = useState('');\n  const [amount, setAmount] = useState('');\n\n  const handleSearch = async (e) => {\n    e.preventDefault();\n    setMessage('');\n    setSearchResult(null);\n    if (!searchPhone) {\n      setMessage('请输入要查询的手机号');\n      return;\n    }\n    const response = await findUser(searchPhone);\n    if (response.success) {\n      setSearchResult(`查询结果: 手机号 ${searchPhone} 对应的ID是 ${response.user.displayId}`);\n    } else {\n      setMessage(response.message || '查询失败');\n    }\n  };\n\n  const handleTransfer = async (e) => {\n    e.preventDefault();\n    setMessage('');\n    const transferAmount = parseInt(amount, 10);\n    if (!recipientId || !transferAmount || transferAmount <= 0) {\n        setMessage('请输入有效的接收人ID和大于0的积分数量');\n        return;\n    }\n    const response = await transferPoints(recipientId, transferAmount);\n    if (response.success) {\n        setMessage(response.message);\n        setRecipientId('');\n        setAmount('');\n        // Notify App.js to refresh the user's points\n        onTransferSuccess();\n    } else {\n        setMessage(response.message || '赠送失败');\n    }\n  };\n\n  return (\n    <div className=\"points-modal-overlay\" onClick={onClose}>\n      <div className=\"points-modal-content\" onClick={(e) => e.stopPropagation()}>\n        <button className=\"close-button\" onClick={onClose}>X</button>\n        <h2>积分管理</h2>\n\n        <div className=\"points-balance\">\n          <h3>我的积分</h3>\n          <p>{currentUser?.points}</p>\n        </div>\n\n        <div className=\"user-search\">\n          <h3>查询玩家ID</h3>\n          <form onSubmit={handleSearch}>\n            <input\n              type=\"text\"\n              placeholder=\"输入对方手机号\"\n              value={searchPhone}\n              onChange={(e) => setSearchPhone(e.target.value)}\n            />\n            <button type=\"submit\">查询</button>\n          </form>\n          {searchResult && <p className=\"search-result\">{searchResult}</p>}\n        </div>\n\n        <div className=\"points-transfer\">\n          <h3>赠送积分</h3>\n          <form onSubmit={handleTransfer}>\n            <input\n              type=\"text\"\n              placeholder=\"对方ID\"\n              value={recipientId}\n              onChange={(e) => setRecipientId(e.target.value)}\n            />\n            <input\n              type=\"number\"\n              placeholder=\"赠送数量\"\n              value={amount}\n              onChange={(e) => setAmount(e.target.value)}\n            />\n            <button type=\"submit\">确认赠送</button>\n          </form>\n        </div>\n\n        {message && <p className=\"message\">{message}</p>}\n      </div>\n    </div>\n  );\n}\n\nexport default PointsManager;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}